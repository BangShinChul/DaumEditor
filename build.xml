<?xml version="1.0"?>
<project name="DaumEditor" basedir="." default="buildall">
	<property file="build.properties" />

    <target name="buildall" description="clean and build all"
            depends="clean, packaging">
	</target>

    <target name="clean" description="remove all artifacts">
       <delete dir="${build.target.dir}" />
       <delete dir="${build.dist.dir}" />
   </target>

    <target name="build" description="build artifacts"
            depends="build-css,build-js"/>

    <target name="packaging" description="packaging distribution files"
            depends="build">
        <echo message="copy javascript and css files" level="info"/>
            <copy todir="${build.dist.dir}" overwrite="true">
                <fileset dir="${build.target.dir}">
                    <exclude name="**/merged/"/>
                    <exclude name="**/merged/*"/>
                    <exclude name="**/escaped/"/>
                    <exclude name="**/escaped/*"/>
                </fileset>
            </copy>

        <echo message="copy image files"/>
            <copy todir="${build.dist.dir}/daumeditor/images" overwrite="true">
                <fileset dir="${src.editor.images.dir}"/>
            </copy>

        <echo message="copy HTML files"/>
            <copy encoding="UTF-8" todir="${build.dist.dir}/daumeditor/pages" overwrite="true">
                <fileset dir="${src.editor.pages.dir}" />
            </copy>

            <copy encoding="UTF-8" todir="${build.dist.dir}/web" overwrite="true">
                <fileset dir="${src.web.dir}">
                    <include name="editor.html" />
                </fileset>
            </copy>
    </target>
	<!-- end of Main Targets -->


	<!-- build javascript -->
	<target name="build-js">
		<echo message="Building JS... ---------------------------------------------------" />
        <mkdir dir="${build.target.editor.js.dir}" />
		<ant antfile="build_js.xml" target="merge_javascripts" />
		<ant antfile="build_js.xml" target="escape_and_delete_logging" />
		<ant antfile="build_js.xml" target="minify_javascripts" />
	</target>


    <!-- build CSS -->
	<target name="build-css">
		<echo message="Building CSS... --------------------------------------------------" />
		<mkdir dir="${build.target.editor.css.dir}" />
		<ant antfile="build_css.xml" target="merge_editor_css" />
		<ant antfile="build_css.xml" target="merge_content_css" />
		<ant antfile="build_css.xml" target="minify_stylesheets" />
	</target>

</project>
